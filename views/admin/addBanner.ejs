<!DOCTYPE html>
<html lang="en"> 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offer Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.min.css" rel="stylesheet">
    <style>
        .status-badge {
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        .status-active {
            background-color: #28a745;
            color: white;
        }
        .status-inactive {
            background-color: #dc3545;
            color: white;
        }
    </style>
</head>
<body> -->
    <!-- Navbar -->
<!-- <nav class="navbar navbar-expand-lg navbar-light bg-light"> -->
    <!-- <a class="navbar-brand" href="#">
        <img src="/img/logo_main.png" width="400" height="70" class="d-inline-block align-top" alt="Your Logo">
        
    </a>
  
</nav>
    <div class="container mt-4">
        <h2 class="mb-4">Offer Management</h2> -->
        
        <!-- Add Offer Button -->
        <!-- <button class="btn btn-primary mb-4" data-bs-toggle="modal" data-bs-target="#addOfferModal">
            Add New Offer
        </button> -->
        

        <!-- Offer List -->
        <!-- <% //if (offers && offers.length > 0) { %>
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Item</th>
                            <th>Percentage</th>
                            <th>Valid From</th>
                            <th>Valid To</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    <!-- </thead> -->
                    <!-- <tbody>
                        <% //offers.forEach(offer => { %>
                            <tr>
                                <td><%= //offer.name %></td>
                                <td><%= //offer.type %></td>
                                <td>
                                    <% //if (offer.type === 'Products') { %>
                                        <%= //offer.productId ? offer.productId.name : 'N/A' %>
                                    <% } else { %>
                                        <%= //offer.categoryId ? offer.categoryId.name : 'N/A' %>
                                    <% } %>
                                </td>
                                <td><%= //offer.offerPercentage %>%</td>
                                <td><%= //new Date(offer.validFrom).toLocaleDateString() %></td>
                                <td><%= //new Date(offer.validTo).toLocaleDateString() %></td>
                                <td>
                                    <%
                                        // const now = new Date();
                                        // const validTo = new Date(offer.validTo);
                                        // const isExpired = validTo < now;
                                        // const statusClass = (offer.status && !isExpired) ? 'status-active' : 'status-inactive';
                                        // const statusText = (offer.status && !isExpired) ? 'Active' : 'Inactive';
                                    %>
                                    <span 
                                        class="status-badge <%= //statusClass %>"
                                        onclick="toggleStatus('<%= //offer._id %>', '<%= //offer.status %>')"
                                        <%=// isExpired ? 'disabled' : '' %>
                                    >
                                        <%=// statusText %>
                                    </span>
                                </td>
                                <td>
                                    <button 
                                        class="btn btn-danger btn-sm"
                                        onclick="deleteOffer('<%=// offer._id %>')"
                                    >
                                        Delete
                                    </button>
                                </td>
                            </tr>
                        <% //}) %>
                    </tbody>
                </table>
            </div>
        <% //} else { %>
            <div class="alert alert-info">No offers added yet.</div> -->
        <%// } %> -->

        <!-- Add Offer Modal -->
        <!-- <div class="modal fade" id="addOfferModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Add New Offer</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="offerForm">
                            <div class="mb-3">
                                <label class="form-label">Offer Type</label>
                                <select class="form-select" name="type" id="offerType" >
                                    <option value="">Select Type</option>
                                    <option value="Products">Product</option>
                                    <option value="Category">Category</option>
                                </select>
                            </div> -->

                            <!-- Dynamic Selection based on Type -->
                            <!-- <div class="mb-3" id="productSelect" style="display: none;">
                                <label class="form-label">Select Product</label>
                                <select class="form-select" name="productId">
                                    <option value="">Select Product</option>
                                    <% product.forEach(p => { %>
                                        <option value="<%= p._id %>"><%= p.name %></option>
                                    <% }) %>
                                </select>
                            </div>

                            <div class="mb-3" id="categorySelect" style="display: none;">
                                <label class="form-label">Select Category</label>
                                <select class="form-select" name="categoryId">
                                    <option value="">Select Category</option>
                                    <% category.forEach(c => { %>
                                        <option value="<%= c._id %>"><%= c.name %></option>
                                    <% }) %>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Offer Name</label>
                                <input type="text" class="form-control" name="name" >
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" name="description" ></textarea>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Offer Percentage</label>
                                <input type="number" class="form-control" name="offerPercentage" min="1" max="100" >
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Valid From</label>
                                <input type="date" class="form-control" name="validFrom" >
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Valid To</label>
                                <input type="date" class="form-control" name="validTo" >
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Per User Limit</label>
                                <input type="number" class="form-control" name="perUser" min="1" >
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Total Usage Limit</label>
                                <input type="number" class="form-control" name="total" min="1" >
                            </div>

                            <button type="submit" class="btn btn-primary">Add Offer</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div> -->

    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.all.min.js"></script>
    
    <script> -->
        <!-- // // Show/hide product or category select based on type
        // document.getElementById('offerType').addEventListener('change', function() {
        //     const productSelect = document.getElementById('productSelect');
        //     const categorySelect = document.getElementById('categorySelect');
            
        //     if (this.value === 'Products') {
        //         productSelect.style.display = 'block';
        //         categorySelect.style.display = 'none';
        //     } else if (this.value === 'Category') {
        //         productSelect.style.display = 'none';
        //         categorySelect.style.display = 'block';
        //     } else {
        //         productSelect.style.display = 'none';
        //         categorySelect.style.display = 'none';
        //     }
        // });

        // // Set minimum date for date inputs
        // const today = new Date().toISOString().split('T')[0];
        // document.querySelector('input[name="validFrom"]').min = today;
        // document.querySelector('input[name="validTo"]').min = today;

        // Form submission
        // document.getElementById('offerForm').addEventListener('submit', async (e) => {
        //     e.preventDefault();
            
        //     const formData = new FormData(e.target);
        //     const data = Object.fromEntries(formData);

        //     try {
        //         const response = await fetch('/admin/offer', {
        //             method: 'POST',
        //             headers: {
        //                 'Content-Type': 'application/json'
        //             },
        //             body: JSON.stringify(data)
        //         });

        //         if (response.ok) {
                    
        //             Swal.fire('Success', 'Offer added successfully', 'success');
        //             location.reload();
        //         } else {
        //             const error = await response.json();
        //             throw new Error(error.error || 'Failed to add offer');
        //         }
        //     } catch (error) {
        //         Swal.fire('Error', error.message, 'error');
        //     }
        // });

        // Toggle offer status
//         async function toggleStatus(offerId, currentStatus) {
//             try {
//                 const newStatus = currentStatus === 'true' ? 'deactivate' : 'activate';
//                 const response = await fetch(`/admin/offers/${offerId}`, {
//                     method: 'POST',
//                     headers: {
//                         'Content-Type': 'application/json'
//                     },
//                     body: JSON.stringify({ status: newStatus })
//                 });

//                 if (response.ok) {
//                     location.reload();
//                 } else {
//                     throw new Error('Failed to update status');
//                 }
//             } catch (error) {
//                 Swal.fire('Error', error.message, 'error');
//             }
//         }

//         // Delete offer
//         async function deleteOffer(offerId) {
//             try {
//                 const result = await Swal.fire({
//                     title: 'Are you sure?',
//                     text: "You won't be able to revert this!",
//                     icon: 'warning',
//                     showCancelButton: true,
//                     confirmButtonColor: '#d33',
//                     cancelButtonColor: '#3085d6',
//                     confirmButtonText: 'Yes, delete it!'
//                 });

//                 if (result.isConfirmed) {
//                     const response = await fetch(`/admin/offers/${offerId}?offerId=${offerId}`, {
//                         method: 'DELETE'
//                     });

//                     if (response.ok) {
//                         Swal.fire('Deleted!', 'Offer has been deleted.', 'success');
//                         location.reload();
//                     } else {
//                         throw new Error('Failed to delete offer');
//                     }
//                 }
//             } catch (error) {
//                 Swal.fire('Error', error.message, 'error');
//             }
        // } -->
    </script>
</body>
</html> 